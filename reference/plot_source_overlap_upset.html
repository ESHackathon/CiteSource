<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Show records found in specific sets of sources to identify the unique contribution
of each source and of any subsets"><title>Create an UpSetR upset plot showing the overlap between sources — plot_source_overlap_upset • CiteSource</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create an UpSetR upset plot showing the overlap between sources — plot_source_overlap_upset"><meta property="og:description" content="Show records found in specific sets of sources to identify the unique contribution
of each source and of any subsets"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">CiteSource</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/citesource_working_example.html">Source Analysis Across Screening Phases</a>
    <a class="dropdown-item" href="../articles/citesource_benchmark_testing.html">Benchmark Testing</a>
    <a class="dropdown-item" href="../articles/citesource_vignette_db-pre-screen_validation.html">Assessing Usefulness of Databases for Evidence Synthesis</a>
    <a class="dropdown-item" href="../articles/citesource_vignette_db-topic-coverage.html">Comparing Database Topic Coverage</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ESHackathon/CiteSource/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create an UpSetR upset plot showing the overlap between sources</h1>
      <small class="dont-index">Source: <a href="https://github.com/ESHackathon/CiteSource/blob/HEAD/R/plots.R" class="external-link"><code>R/plots.R</code></a></small>
      <div class="d-none name"><code>plot_source_overlap_upset.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Show records found in specific sets of sources to identify the unique contribution
of each source and of any subsets</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_source_overlap_upset</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  groups <span class="op">=</span> <span class="st">"source"</span>,</span>
<span>  nsets <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sets.x.label <span class="op">=</span> <span class="st">"Number of records"</span>,</span>
<span>  mainbar.y.label <span class="op">=</span> <span class="st">"Overlapping record count"</span>,</span>
<span>  order.by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"freq"</span>, <span class="st">"degree"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A tibble with one record per row, an id column and then one column
per source indicating whether the record was found in that source.</p></dd>


<dt>groups</dt>
<dd><p>Variable to use as groups. Should be 'source', 'label' or 'string' - defaults to source.</p></dd>


<dt>nsets</dt>
<dd><p>Number of sets to look at</p></dd>


<dt>sets.x.label</dt>
<dd><p>The x-axis label of the set size bar plot</p></dd>


<dt>mainbar.y.label</dt>
<dd><p>The y-axis label of the intersection size bar plot</p></dd>


<dt>order.by</dt>
<dd><p>How the intersections in the matrix should be ordered by. Options include frequency (entered as "freq"), degree, or both in any order.</p></dd>


<dt>...</dt>
<dd><p>Arguments passed on to <code><a href="https://rdrr.io/pkg/UpSetR/man/upset.html" class="external-link">UpSetR::upset</a></code></p><dl><dt><code>nintersects</code></dt>
<dd><p>Number of intersections to plot. If set to NA, all intersections will be plotted.</p></dd>

    <dt><code>sets</code></dt>
<dd><p>Specific sets to look at (Include as combinations. Ex: c("Name1", "Name2"))</p></dd>

    <dt><code>keep.order</code></dt>
<dd><p>Keep sets in the order entered using the sets parameter. The default is FALSE, which orders the sets by their sizes.</p></dd>

    <dt><code>set.metadata</code></dt>
<dd><p>Metadata that offers insight to an attribute of the sets. Input should be a data frame where the first column is set names, and the
remaining columns are attributes of those sets. To learn how to use this parameter it is highly suggested to view the set metadata vignette. The link
can be found on the package's GitHub page.</p></dd>

    <dt><code>intersections</code></dt>
<dd><p>Specific intersections to include in plot entered as a list of lists.
Ex: list(list("Set name1", "Set name2"), list("Set name1", "Set name3")). If data is entered into this parameter the only data shown on the UpSet plot
will be the specific intersections listed.</p></dd>

    <dt><code>matrix.color</code></dt>
<dd><p>Color of the intersection points</p></dd>

    <dt><code>main.bar.color</code></dt>
<dd><p>Color of the main bar plot</p></dd>

    <dt><code>mainbar.y.max</code></dt>
<dd><p>The maximum y value of the intersection size bar plot scale. May be useful when aligning multiple UpSet plots horizontally.</p></dd>

    <dt><code>sets.bar.color</code></dt>
<dd><p>Color of set size bar plot</p></dd>

    <dt><code>point.size</code></dt>
<dd><p>Size of points in matrix plot</p></dd>

    <dt><code>line.size</code></dt>
<dd><p>Width of lines in matrix plot</p></dd>

    <dt><code>mb.ratio</code></dt>
<dd><p>Ratio between matrix plot and main bar plot (Keep in terms of hundredths)</p></dd>

    <dt><code>expression</code></dt>
<dd><p>Expression to subset attributes of intersection or element query data. Enter as string (Ex: "ColName &gt; 3")</p></dd>

    <dt><code>att.pos</code></dt>
<dd><p>Position of attribute plot. If NULL or "bottom" the plot will be at below UpSet plot. If "top" it will be above UpSet plot</p></dd>

    <dt><code>att.color</code></dt>
<dd><p>Color of attribute histogram bins or scatterplot points for unqueried data represented by main bars. Default set to color of main bars.</p></dd>

    <dt><code>decreasing</code></dt>
<dd><p>How the variables in order.by should be ordered. "freq" is decreasing (greatest to least) and "degree" is increasing (least to greatest)</p></dd>

    <dt><code>show.numbers</code></dt>
<dd><p>Show numbers of intersection sizes above bars</p></dd>

    <dt><code>number.angles</code></dt>
<dd><p>The angle of the numbers atop the intersection size bars</p></dd>

    <dt><code>group.by</code></dt>
<dd><p>How the data should be grouped ("degree" or "sets")</p></dd>

    <dt><code>cutoff</code></dt>
<dd><p>The number of intersections from each set (to cut off at) when aggregating by sets</p></dd>

    <dt><code>queries</code></dt>
<dd><p>Unified query of intersections, elements, and custom row functions. Entered as a list that contains a list of
queries. query is the type of query being conducted. params are the parameters of the query (if any). color is the color of the points on the
plot that will represent the query. If no color is selected one will be provided automatically. active takes TRUE or FALSE, and if
TRUE, it will overlay the bars present  with the results from the query. If FALSE a tick mark will indicate the intersection size.
See examples section on how to do this.</p></dd>

    <dt><code>query.legend</code></dt>
<dd><p>Position query legend on top or bottom of UpSet plot</p></dd>

    <dt><code>shade.color</code></dt>
<dd><p>Color of row shading in matrix</p></dd>

    <dt><code>shade.alpha</code></dt>
<dd><p>Transparency of shading in matrix</p></dd>

    <dt><code>matrix.dot.alpha</code></dt>
<dd><p>Transparency of the empty intersections points in the matrix</p></dd>

    <dt><code>empty.intersections</code></dt>
<dd><p>Additionally display empty sets up to nintersects</p></dd>

    <dt><code>color.pal</code></dt>
<dd><p>Color palette for attribute plots</p></dd>

    <dt><code>boxplot.summary</code></dt>
<dd><p>Boxplots representing the distribution of a selected attribute for each intersection. Select attributes by entering a character vector of attribute names (e.g. c("Name1", "Name2")).
The maximum number of attributes that can be entered is 2.</p></dd>

    <dt><code>attribute.plots</code></dt>
<dd><p>Create custom ggplot using intersection data represented in the main bar plot. Prior to adding custom plots, the UpSet plot is set up in a 100 by 100 grid.
The attribute.plots parameter takes a list that contains the number of rows that should be allocated for the custom plot, and a list of plots with specified positions.
nrows is the number of rows the custom plots should take up. There is already 100 allocated for the custom plot. plots takes a list that contains a function that returns
a custom ggplot and the x and y aesthetics for the function. ncols is the number of columns that your ggplots should take up. See examples for how to add custom ggplots.</p></dd>

    <dt><code>scale.intersections</code></dt>
<dd><p>The scale to be used for the intersection sizes. Options: "identity", "log10", "log2"</p></dd>

    <dt><code>scale.sets</code></dt>
<dd><p>The scale to be used for the set sizes. Options: "identity", "log10", "log2"</p></dd>

    <dt><code>text.scale</code></dt>
<dd><p>Numeric, value to scale the text sizes, applies to all axis labels, tick labels, and numbers above bar plot. Can be a universal scale, or a vector containing individual scales
in the following format: c(intersection size title, intersection size tick labels, set size title, set size tick labels, set names, numbers above bars)</p></dd>

    <dt><code>set_size.angles</code></dt>
<dd><p>Numeric, angle to rotate the set size plot x-axis text</p></dd>

    <dt><code>set_size.show</code></dt>
<dd><p>Logical, display the set sizes on the set size bar chart</p></dd>

    <dt><code>set_size.numbers_size</code></dt>
<dd><p>If set_size.show is TRUE, adjust the size of the numbers</p></dd>

    <dt><code>set_size.scale_max</code></dt>
<dd><p>Increase the maximum of set size scale</p></dd>

  
</dl></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Conway, J. R., Lex, A., &amp; Gehlenborg, N. (2017). UpSetR: an R package for the visualization of intersecting sets and their properties. Bioinformatics.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  article_id <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,</span></span>
<span class="r-in"><span>  source__source1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  source__source2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">.2</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  source__source3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">.1</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  source__source4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">.6</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  source__source5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">500</span>, <span class="fl">1</span>, <span class="fl">.7</span><span class="op">)</span> <span class="op">==</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_source_overlap_upset</span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_source_overlap_upset-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To start with the records shared among the greatest number of sources, use</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">plot_source_overlap_upset</span><span class="op">(</span><span class="va">data</span>, decreasing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_source_overlap_upset-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Trevor Riley, Kaitlyn Hair, Lukas Wallrich, Matthew Grainger, Sarah Young, Chris Pritchard, Neal Haddaway.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

